<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Restoraunt order</title>
</head>
<body>
  <div class="main">
    <div class="logo">
      <img src="./logo.png" alt="" id="logo">
    </div>
    <div class="orderlist">
      <h2>LOCAL TAPAS</h2>
      <ul class="plates">
        <li class="row">Loading items...</li>
      </ul>
      <form class="sendform">
        <input type="text" name="item" required>
        <input type="submit" value="+ Add item">
      </form>
    </div>
  </div>

<script>
  const addItems = document.querySelector('.sendform');
  const itemList = document.querySelector('.plates');
  const items = JSON.parse(localStorage.getItem('items')) || [];

  function addItem (e) {
    e.preventDefault();
    const text = (this.querySelector('[name=item]')).value;
    const item = {
      text,
      done: false
    }
    items.push(item);
    localStorage.setItem('items', JSON.stringify(items));
    populateList(items, itemList);
    this.reset();
  };

  function populateList(plates = [], platesList) {
    platesList.innerHTML = plates.map((plate, i) => {
      return `
        <li class='row'>
          <input type="checkbox" data-index=${i} id=item${i} ${plate.done ? 'checked': ''} />
          <label for="item${i}">${plate.text}</label>
        </li>
      `
    }).join('');
  }

  function togleDone (e) {
    if (!e.target.matches('input')) return;
    const el = e.target;
    const index = el.dataset.index;
    items[index].done = !items[index].done;
  }

  addItems.addEventListener('submit', addItem);
  itemList.addEventListener('click', togleDone);
  populateList(items, itemList);

</script>

</body>
</html>